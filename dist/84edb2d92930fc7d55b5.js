(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{21:function(e,t,s){e.exports=s.p+"images/9367c563faf1e2ef8c39edd4e7cacdd1.svg"},22:function(e,t,s){e.exports=s.p+"images/33bce9168d45217acdba8d6b52a52ca7.svg"},23:function(e,t,s){e.exports=s.p+"images/be05ab98f5a880cf9a4ffc8a091ef71a.svg"},24:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[e.showPopup?a("TalkToSpeakerPopup",{on:{close:function(t){e.showPopup=!1},question:function(t){e.actualQuestion=t}}},[a("ClonedVideo",{attrs:{isCameraOn:e.isCameraOn}}),a("VideoCheck",{attrs:{isCameraOn:e.isCameraOn},on:{toggleLocalCamera:e.toggleLocalCamera}}),a("StartStreamButton",{attrs:{title:"Готово"},on:{toggleRoom:e.togglePublish}})],1):e._e(),a("GuestHeader"),a("div",{staticClass:"speaker speaker_guest"},[a("div",{staticClass:"speaker__container speaker__container_guest"},[a("div",{staticClass:"speaker__wrapper-guest"},[a("h2",{staticClass:"speaker__heading"},[e._v("Спикер")]),a("div",{class:[e.hasSpeaker?"":"video-container_speaker","video-container"]},[e.hasSpeaker?e._e():a("p",{staticClass:"video-container__label"},[e._v("Диалог скоро начнётся")]),a("video",{directives:[{name:"show",rawName:"v-show",value:e.hasSpeaker,expression:"hasSpeaker"}],staticClass:"video-box video-box_guest",attrs:{id:"speakerVideo",autoplay:"",playsinline:""}})])]),a("div",{staticClass:"speaker__wrapper-guest"},[a("h2",{staticClass:"speaker__heading"},[e._v("Сейчас на связи")]),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isYourStreamStarted,expression:"!isYourStreamStarted"}],class:[e.hasGuest?"":"video-container_guest","video-container"]},[e.hasGuest?e._e():a("p",{staticClass:"video-container__label"},[e._v("Для начала диалога"),a("br"),e._v("задайте вопрос спикеру")]),a("video",{ref:"guestVideo",staticClass:"video-box video-box_guest",attrs:{id:"guestVideo",autoplay:"",playsinline:""}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isYourStreamStarted,expression:"isYourStreamStarted"}],class:[e.hasGuest?"video-container_guest":"","video-container"]},[a("video",{ref:"myVideo",staticClass:"video-box video-box_guest",attrs:{id:"myVideo",autoplay:"",muted:"",playsinline:""},domProps:{muted:!0}})]),a("div",{staticClass:"guest-questions guest-questions_guest"},[e.hasGuest?e._e():a("div",[e.isYourStreamStarted?e._e():a("button",{staticClass:"button",on:{click:e.showDialogWindow}},[e._v("Задать вопрос спикеру")])]),e.isYourStreamStarted?a("div",{staticClass:"guest-controls"},[a("div",{staticClass:"guest-controls__buttons"},[a("div",{class:[e.isMicOn?"":"guest-controls__item_disabled","guest-controls__item"],on:{click:e.toggleLocalMic}},[a("img",{attrs:{src:s(21)}})]),a("div",{class:[e.isCameraOn?"":"guest-controls__item_disabled","guest-controls__item"],on:{click:e.toggleLocalCamera}},[a("img",{attrs:{src:s(22)}})])]),a("div",{staticClass:"guest-controls__leave"},[a("button",{staticClass:"button button_red",on:{click:e.unpublish}},[e._v("Выйти из диалога")])])]):e._e()])])])])],1)};a._withStripped=!0;var i=s(13),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"popup"},[a("div",{staticClass:"popup__container"},[a("div",{class:[e.videoCheck?"popup__window_check":"","popup__window"]},[a("img",{staticClass:"popup__close",attrs:{src:s(23),alt:"крестик"},on:{click:function(t){return e.$emit("close")}}}),a("div",{staticClass:"popup__wrapper"},[e.videoCheck?a("div",{staticClass:"popup__check-wrapper"},[a("p",{staticClass:"popup__title popup__title_check"},[e._v("Когда настанет ваша очередь вы подключитесь к видеочату со спикером. Настройте своё изображение.")]),e._t("default")],2):e._e(),e.videoCheck?e._e():a("div",[a("h1",{staticClass:"popup__header"},[e._v("Пообщаться со спикером")]),a("p",{staticClass:"popup__title"},[e._v("Заполните форму для того, чтобы встать в очередь и обсудить со спикером ваш вопрос")]),a("div",{staticClass:"form"},[a("form",{on:{submit:function(t){return t.preventDefault(),e.sendQuestion(t)}}},[a("div",{staticClass:"form__item"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"form__input",attrs:{placeholder:"ФИО",type:"text",required:""},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.job,expression:"job"}],staticClass:"form__input",attrs:{placeholder:"Должность",type:"text",required:""},domProps:{value:e.job},on:{input:function(t){t.target.composing||(e.job=t.target.value)}}})]),a("div",{staticClass:"form__item"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.company,expression:"company"}],staticClass:"form__input",attrs:{placeholder:"Компания",type:"text",required:""},domProps:{value:e.company},on:{input:function(t){t.target.composing||(e.company=t.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"form__input",attrs:{placeholder:"E-Mail",type:"email",required:""},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})]),a("div",{staticClass:"form__item"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.question,expression:"question"}],staticClass:"form__text-input",attrs:{required:""},domProps:{value:e.question},on:{input:function(t){t.target.composing||(e.question=t.target.value)}}})]),e._m(0)])])])])])])])};o._withStripped=!0;var r={name:"TalkToSpeakerPopup",data:()=>({videoCheck:!0,name:"",job:"",company:"",email:"",question:""}),methods:{sendQuestion(){this.$emit("question",this.question),this.videoCheck=!0}}},n=s(1),l=Object(n.a)(r,o,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"form__wrapper"},[t("p",{staticClass:"form__policy"},[this._v("Нажимая на кнопку «Задать вопрос» вы"),t("br"),this._v("соглашаетесь с "),t("span",[t("a",[this._v("политикой конфиденциальности")])])]),t("div",{staticClass:"form__button"},[t("button",{staticClass:"button"},[this._v("Задать вопрос")])])])}],!1,null,null,null);l.options.__file="src/components/TalkToSpeakerPopup.vue";var d=l.exports,c=s(14),u=s(15),m=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"speaker__wrap speaker__wrap_initial"},[t("video",{ref:"video",staticClass:"video-box video-box_initial",attrs:{playsinline:"",muted:"",autoplay:""},domProps:{muted:!0}})])};m._withStripped=!0;var p={name:"ClonedVideo",props:["isCameraOn"],data:()=>({video:{},isVideoActive:!0}),watch:{isCameraOn:{handler(){this.toggleCamera()}}},mounted(){this.startCameraStream()},methods:{toggleCamera(){this.isVideoActive?this.stopCameraStream():this.startCameraStream()},startCameraStream(){this.isVideoActive=!0;const e=window.constraints={audio:!1,video:!0};navigator.mediaDevices.getUserMedia(e).then(e=>{this.$refs.video.srcObject=e}).catch(e=>{console.log(e)})},stopCameraStream(){this.isVideoActive=!1,this.$refs.video.srcObject.getTracks().forEach(e=>{e.stop()})}}},h=Object(n.a)(p,m,[],!1,null,"b2c10bd8",null);h.options.__file="src/components/ClonedVideo.vue";var _=h.exports,v=function(){var e=this.$createElement;this._self._c;return this._m(0)};v._withStripped=!0;var g={name:"GuestHeader"},C=Object(n.a)(g,v,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"guest-header"},[t("div",{staticClass:"guest-header__container"},[t("div",{staticClass:"guest-header__wrapper"},[t("h1",{staticClass:"guest-header__heading"},[this._v("AIJ: общение на стенде")]),t("div",{staticClass:"guest-header__bage"},[t("div",{staticClass:"guest-header__live-icon"}),t("p",{staticClass:"guest-header__live"},[this._v("LIVE")])])])])])}],!1,null,null,null);C.options.__file="src/layouts/GuestHeader.vue";var b=C.exports,f={name:"Guest",props:["roomName"],components:{StartStreamButton:u.a,VideoCheck:c.a,TalkToSpeakerPopup:d,ClonedVideo:_,GuestHeader:b},data:()=>({isYourStreamStarted:!1,guestVideoId:"guestVideo",myVideoId:"myVideo",actualQuestion:"",showPopup:!1,devicesAllowed:!1,isMicOn:!0,isCameraOn:!0,hasGuest:!1,hasSpeaker:!1,myStreamId:null,guestStreamId:null,speakerStreamId:null,published:!1,webRTCAdaptor:void 0}),mounted(){this.initGuestWebRTCAdaptor()},methods:{showDialogWindow(){this.showPopup=!0},initGuestWebRTCAdaptor(){this.webRTCAdaptor=new i.a({websocket_url:"wss://ant2.tooladigital.ru:5443/WebRTCAppEE/websocket",mediaConstraints:{video:!0,audio:!0},peerconnection_config:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},sdp_constraints:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0},localVideoId:"myVideo",isPlayMode:!1,debug:!1,callback:(e,t)=>{if("initialized"===e)this.log("INITIALIZED"),this.devicesAllowed=!0,this.webRTCAdaptor.joinRoom(this.roomName,this.myStreamId);else if("joinedTheRoom"===e)this.log("JOINED THE ROOM"),this.myStreamId=t.streamId,this.$refs.myVideo.srcObject=this.webRTCAdaptor.localStream,1===t.streams.length?(this.speakerStreamId=t.streams[0],this.webRTCAdaptor.play(this.speakerStreamId,null,this.roomNameBox)):2===t.streams.length&&(this.guestStreamId=t.streams[0],this.webRTCAdaptor.play(t.streams[0],null,this.roomNameBox),this.speakerStreamId=t.streams[1],this.webRTCAdaptor.play(t.streams[1],null,this.roomNameBox));else if("streamInformation"===e)this.webRTCAdaptor.play(this.roomName);else if("newStreamAvailable"===e){if(this.log("NEW STREAM AVAILABLE"),null===this.speakerStreamId||this.speakerStreamId===t.streamId){document.getElementById("speakerVideo").srcObject=t.stream,this.speakerStreamId=t.streamId,this.hasSpeaker=!0}else null!==this.guestStreamId&&this.guestStreamId!==t.streamId||(this.$refs.guestVideo.srcObject=t.stream,this.guestStreamId=t.streamId,this.hasGuest=!0);this.webRTCAdaptor.play(t.streamId,null,this.roomNameBox)}else if("streamJoined"===e)this.log("STREAM JOINED: "+t.streamId),this.webRTCAdaptor.play(t.streamId,null,this.roomName);else if("streamLeaved"===e){if(this.log("STREAM LEAVED: "+t.streamId),this.speakerStreamId===t.streamId){this.log("REMOVE SRC SPEAKER");document.getElementById("speakerVideo").srcObject=null,this.hasSpeaker=!1,this.speakerStreamId=null}else if(this.guestStreamId===t.streamId){this.log("REMOVE SRC GUEST");document.getElementById("guestVideo").srcObject=null,this.hasGuest=!1,this.guestStreamId=null}}else"publish_started"===e?(this.log("PUBLISH STARTED"),this.published=!0,this.isYourStreamStarted=!0):"publish_finished"===e?(this.log("PUBLISH FINISHED"),this.published=!1,this.isYourStreamStarted=!1):"leavedFromRoom"===e?(this.log("LEAVED THE ROOM"),this.webRTCAdaptor.joinRoom(this.roomName,this.myStreamId)):"closed"===e&&this.log("CONNECTION CLOSED")},callbackError:e=>{"no_stream_exist"===e?this.log("NO STREAM EXIST"):"notSetRemoteDescription"===e?this.log("Getting codec incompatible or remote description error"):-1!==e.indexOf("NotAllowedError")||-1!==e.indexOf("PermissionDeniedError")?this.devicesAllowed=!1:this.log("error callback: "+JSON.stringify(e))}})},publish(){this.isYourStreamStarted=!0,this.webRTCAdaptor.publish(this.myStreamId)},unpublish(){this.isYourStreamStarted=!1,this.actualQuestion="",this.webRTCAdaptor.leaveFromRoom(this.roomName)},togglePublish(){this.showPopup=!1,this.published?this.unpublish():this.publish()},toggleLocalCamera(){this.isCameraOn?this.turnOffLocalCamera():this.turnOnLocalCamera()},toggleLocalMic(){this.isMicOn?this.muteLocalMic():this.unmuteLocalMic()},turnOffLocalCamera(){this.webRTCAdaptor.turnOffLocalCamera(),this.isCameraOn=!1,this.sendNotificationEvent("CAM_TURNED_OFF")},turnOnLocalCamera(){this.webRTCAdaptor.turnOnLocalCamera(),this.isCameraOn=!0,this.sendNotificationEvent("CAM_TURNED_ON")},muteLocalMic(){this.webRTCAdaptor.muteLocalMic(),this.isMicOn=!1,this.sendNotificationEvent("MIC_MUTED")},unmuteLocalMic(){this.webRTCAdaptor.unmuteLocalMic(),this.isMicOn=!0,this.sendNotificationEvent("MIC_UNMUTED")},sendNotificationEvent(e){if(this.isDataChannelOpen){const t={streamId:this.publishStreamId,eventType:e};this.webRTCAdaptor.sendData(this.publishStreamId,JSON.stringify(t))}else this.log("Could not send the notification because data channel is not open.")},log(e){0}}},S=Object(n.a)(f,a,[],!1,null,null,null);S.options.__file="src/pages/Guest.vue";t.default=S.exports}}]);